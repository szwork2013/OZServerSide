var XLS = require('xlsjs');

exports = module.exports = xls_json;

function xls_json (file, options, callback) {

	if(arguments.length > 3) {
		console.error("Argument should be below 3");
		process.exit(1);
	}else if(arguments.length == 2) {
		callback = options;
		options = null;
	}else if(arguments.length < 2) {
		console.error("Argument should be greater than 2");
		process.exit(2);
	}

	// workbook arguments (fileName, options)
	if(options) {
		// have options
		var workbook = XLS.readFile(file, options)
	}else {
		// no options
		var workbook = XLS.readFile(file);
	}

	var sheet_name_list = workbook.SheetNames;
	var list_length = sheet_name_list.length;
	// saving sheets, data to this array
	var sheet_arr = [];

	// workbook sheet name
	for(i = 0; i < list_length; i++) {
		var sheet = workbook.Sheets[sheet_name_list[i]];
		sheet.sheetName = sheet_name_list[i];
		sheet_arr.push(sheet);
	}

	callback(null, sheet_arr);
}